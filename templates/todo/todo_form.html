{% load widget_tweaks %}

<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="mb-3">
        <label for="{{ form.title.id_for_label }}" class="form-label">{{ form.title.label }}</label>
        {{ form.title|add_class:"form-control" }}
        {% for error in form.title.errors %}
            <div class="text-danger small">{{ error }}</div>
        {% endfor %}
    </div>
    <div class="mb-3">
        <label for="{{ form.description.id_for_label }}" class="form-label">{{ form.description.label }}</label>
        {{ form.description }}
        {% for error in form.description.errors %}
            <div class="text-danger small">{{ error }}</div>
        {% endfor %}
    </div>
    <div class="mb-3">
        <label for="{{ form.start_date.id_for_label }}" class="form-label">{{ form.start_date.label }}</label>
        {{ form.start_date|add_class:"form-control" }}
        {% for error in form.start_date.errors %}
            <div class="text-danger small">{{ error }}</div>
        {% endfor %}
    </div>
    <div class="mb-3">
        <label for="{{ form.end_date.id_for_label }}" class="form-label">{{ form.end_date.label }}</label>
        {{ form.end_date|add_class:"form-control" }}
        {% for error in form.end_date.errors %}
            <div class="text-danger small">{{ error }}</div>
        {% endfor %}
    </div>

    {% if form.is_completed %}
    <div class="form-check mb-3">
        {{ form.is_completed|add_class:"form-check-input" }}
        <label class="form-check-label ms-2" for="{{ form.is_completed.id_for_label }}">{{ form.is_completed.label }}</label>
        {% for error in form.is_completed.errors %}
            <div class="text-danger small">{{ error }}</div>
        {% endfor %}
    </div>
    {% endif %}

    {% if form.completed_image %}
    <div class="mb-3">
        <label for="{{ form.completed_image.id_for_label }}" class="form-label">{{ form.completed_image.label }}</label>
        {{ form.completed_image|add_class:"form-control" }}
        {% if object and object.completed_image %}
            <p>현재 이미지: <img src="{{ object.completed_image.url }}" alt="completed image" style="height: 100px;"></p>
        {% endif %}
        {% for error in form.completed_image.errors %}
            <div class="text-danger small">{{ error }}</div>
        {% endfor %}
    </div>
    {% endif %}

    <button type="submit" class="btn btn-primary">{% if object %}수정 완료{% else %}생성{% endif %}</button>
    <a href="{% url 'cbv_todo_list' %}" class="btn btn-secondary">취소</a>
</form>
